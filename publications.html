<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Deepak Kumar | Publications</title>
    <link rel="stylesheet" href="css/style.css" />
    <style>
      /* --- Controls Bar --- */
      .controls-bar {
        display: flex;
        gap: 1rem;
        margin-bottom: 1rem;
        position: relative;
        z-index: 100;
      }

      .dropdown {
        position: relative;
      }

      .btn-control {
        padding: 0.6rem 1.2rem;
        background-color: #fff;
        border: 1px solid #ced4da;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.95rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.2s;
      }

      .btn-control:hover {
        background-color: #f8f9fa;
        border-color: #adb5bd;
      }

      .dropdown-menu {
        display: none;
        position: absolute;
        background-color: #fff;
        min-width: 220px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        border: 1px solid #ddd;
        border-radius: 4px;
        top: 110%;
        left: 0;
        padding: 0.5rem 0;
      }

      .dropdown-menu.show {
        display: block;
      }

      /* Sort Options */
      .sort-option {
        padding: 0.6rem 1rem;
        cursor: pointer;
        display: block;
        width: 100%;
        text-align: left;
        border: none;
        background: none;
        font-size: 0.9rem;
        color: #333;
      }

      .sort-option:hover {
        background-color: #f1f1f1;
      }

      .sort-option.active {
        font-weight: 600;
        color: #3498db;
        background-color: #e8f4fc;
      }

      /* Filter Categories */
      .filter-category {
        position: relative;
        padding: 0.6rem 1rem;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.9rem;
        color: #333;
      }

      .filter-category:hover {
        background-color: #f1f1f1;
      }

      .filter-category::after {
        content: "›";
        font-weight: bold;
        color: #999;
      }

      /* Submenu */
      .submenu {
        display: none;
        position: absolute;
        left: 100%;
        top: -1px;
        background-color: #fff;
        min-width: 280px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        border: 1px solid #ddd;
        border-radius: 4px;
        max-height: 300px;
        overflow-y: auto;
        padding: 0.5rem 0;
      }

      .filter-category:hover .submenu {
        display: block;
      }

      .submenu-item {
        padding: 0.5rem 1rem;
        display: flex;
        align-items: flex-start;
        gap: 0.6rem;
        font-size: 0.9rem;
        color: #555;
        cursor: pointer;
      }

      .submenu-item:hover {
        background-color: #f8f9fa;
      }

      .submenu-item input[type="checkbox"] {
        margin-top: 0.2rem;
      }

      /* Year Inputs in Submenu */
      .year-inputs {
        padding: 1rem;
        display: flex;
        gap: 0.5rem;
        align-items: center;
      }

      .year-inputs input {
        width: 80px;
        padding: 0.4rem;
        border: 1px solid #ced4da;
        border-radius: 4px;
      }

      .year-inputs button {
        padding: 0.4rem 0.8rem;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      /* Active Filters Chips */
      .active-filters {
        display: flex;
        flex-wrap: wrap;
        gap: 0.6rem;
        margin-bottom: 2rem;
        min-height: 10px;
      }

      /* Filter Panel (Horizontal Stack) */
      .filter-panel {
        display: none; /* Toggled by JS */
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        background: #f8f9fa;
        padding: 1.5rem;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        margin-top: 1rem;
        margin-bottom: 1rem;
        width: 100%;
        box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
      }

      .filter-panel.show {
        display: grid;
      }

      .filter-widget {
        position: relative;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }
      
      .filter-widget label {
        font-size: 0.85rem;
        font-weight: 600;
        color: #555;
      }

      .filter-input {
        width: 100%;
        padding: 0.6rem;
        border: 1px solid #ced4da;
        border-radius: 4px;
        font-size: 0.9rem;
      }

      .filter-input:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
      }

      .options-list {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        border: 1px solid #ced4da;
        border-top: none;
        max-height: 250px;
        overflow-y: auto;
        z-index: 1000;
        display: none;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        border-radius: 0 0 4px 4px;
      }

      .options-list.show {
        display: block;
      }

      .option-item {
        padding: 0.6rem 0.8rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
        color: #333;
        border-bottom: 1px solid #f1f1f1;
      }

      .option-item:last-child {
        border-bottom: none;
      }

      .option-item:hover {
        background-color: #e3f2fd;
        color: #1565c0;
      }

      .year-widget-inputs {
        display: flex;
        gap: 0.5rem;
        align-items: center;
      }
      
      .year-widget-inputs input {
        width: 100%;
        padding: 0.6rem;
        border: 1px solid #ced4da;
        border-radius: 4px;
      }

      .filter-chip {
        background-color: #e3f2fd;
        color: #1565c0;
        padding: 0.3rem 0.8rem;
        border-radius: 20px;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        border: 1px solid #bbdefb;
      }

      .filter-chip .close-btn {
        background: none;
        border: none;
        color: #1565c0;
        cursor: pointer;
        font-weight: bold;
        padding: 0;
        font-size: 1.1rem;
        line-height: 1;
        display: flex;
        align-items: center;
      }

      .filter-chip .close-btn:hover {
        color: #0d47a1;
      }

      .pub-list-dynamic {
        min-height: 300px;
      }

      .pub-tag {
        display: inline-block;
        background: #f1f3f5;
        color: #495057;
        padding: 0.2rem 0.6rem;
        border-radius: 4px;
        font-size: 0.75rem;
        margin-left: 0.5rem;
        font-weight: 500;
        border: 1px solid #dee2e6;
      }

      .pub-link {
        display: inline-block;
        margin-left: 0.5rem;
        color: #3498db;
        text-decoration: none;
        font-size: 0.85rem;
        font-weight: 600;
      }

      .pub-link:hover {
        text-decoration: underline;
        color: #2980b9;
      }
    </style>
  </head>
  <body>
    <header class="site-header">
      <div class="container header-inner">
        <div class="brand">
          <span class="brand-mark"></span>
          <span class="brand-text">Deepak Kumar</span>
        </div>
        <nav class="nav-links">
          <a href="index.html">Home</a>
          <a href="about.html">About Me</a>
          <a href="research.html">Research</a>
          <a href="publications.html" class="active">Publications</a>
          <a href="contact.html">Contact</a>
        </nav>
      </div>
    </header>

    <main class="main-content">
      <section class="card container">
        <!-- <h2>Publications</h2> -->
        <p>
          A complete list of my publications is given below. For the most up-to-date information,
          you can also visit my <a href="https://scholar.google.com/citations?user=558DmkQAAAAJ&hl=en" target="_blank" rel="noopener">Google Scholar</a>. 
        </p>
      

        <!-- Controls Bar -->
        <div class="controls-bar">
          <!-- Sort Dropdown -->
          <div class="dropdown">
            <button id="sort-btn" class="btn-control">
              Sort By <span style="font-size: 0.8rem;">▼</span>
            </button>
            <div id="sort-menu" class="dropdown-menu">
              <button class="sort-option active" data-value="year-desc">Year (Newest First)</button>
              <button class="sort-option" data-value="year-asc">Year (Oldest First)</button>
              <button class="sort-option" data-value="title-asc">Title (A-Z)</button>
              <button class="sort-option" data-value="journal-asc">Journal (A-Z)</button>
            </div>
          </div>

          <!-- Filter Toggle Button -->
          <button id="filter-toggle-btn" class="btn-control">
            Filter Options <span style="font-size: 0.8rem;">▼</span>
          </button>
        </div>

        <!-- Filter Panel (Horizontal Stack) -->
        <div id="filter-panel" class="filter-panel">
          
          <!-- Research Area -->
          <div class="filter-widget">
            <label>Research Area</label>
            <select class="filter-input" id="select-area">
              <option value="">Select Area...</option>
            </select>
          </div>

          <!-- Journal -->
          <div class="filter-widget">
            <label>Journal</label>
            <select class="filter-input" id="select-journal">
              <option value="">Select Journal...</option>
            </select>
          </div>

          <!-- Co-author -->
          <div class="filter-widget">
            <label>Co-author</label>
            <input type="text" class="filter-input" id="input-author" placeholder="Type to search author..." autocomplete="off">
            <div class="options-list" id="list-author">
              <!-- Populated by JS -->
            </div>
          </div>

          <!-- Article Type -->
          <div class="filter-widget">
            <label>Article Type</label>
            <select class="filter-input" id="select-type">
              <option value="">Select Type...</option>
            </select>
          </div>

          <!-- Year Range -->
          <div class="filter-widget">
            <label>Year Range</label>
            <div class="year-widget-inputs">
              <input type="number" id="year-start" placeholder="Start" min="2000" max="2030">
              <span>-</span>
              <input type="number" id="year-end" placeholder="End" min="2000" max="2030">
            </div>
          </div>

        </div>

        <!-- Active Filters Display -->
        <div id="active-filters" class="active-filters">
          <!-- Chips populated by JS -->
        </div>

        <div id="publications-container" class="pub-list-dynamic">
          <!-- Publications will be injected here -->
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>&copy; Deepak Kumar. Last updated 2025.</p>
      </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
      // Publication Data
      const publications = [
        {
          id: 1,
          title: "Integrating Quantum Descriptors and Kolmogorov Arnold Network (KAN) for Modeling and Optimization of CO₂-binding organic liquids (CO₂BOLs)",
          authors: ["Kumar, D.", "Anwer, S.", "Alhajaj, A.", "Kodamana, H.", "Ramteke, M."],
          journal: "Industrial & Engineering Chemistry Research",
          year: "Under Review",
          area: ["KANs & Sustainable Processes"],
          status: "Under Review",
          type: "Journal Article",
          url: "#"
        },
        {
          id: 2,
          title: "Learning System Physics using Symbolic Neural Integration (SyNISM) with Applications to Chemical Processes",
          authors: ["Kumar, D.", "Dixit, V.", "Kodamana, H.", "Ramteke, M."],
          journal: "Industrial & Engineering Chemistry Research",
          year: "2025",
          area: ["Symbolic AI (SyNISM)"],
          status: "Published",
          type: "Journal Article",
          url: "#"
        },
        {
          id: 3,
          title: "A framework for model maintenance using kernel-based forward propagating neural networks",
          authors: ["Kumar, D.", "Ramteke, M.", "Kodamana, H."],
          journal: "Chemical Engineering Research and Design",
          year: "2024",
          area: ["Process Modeling"],
          status: "Published",
          type: "Journal Article",
          url: "#"
        },
        {
          id: 4,
          title: "Variance-capturing forward-forward autoencoder (VFFAE): A forward learning neural network for fault detection and isolation of process data",
          authors: ["Kumar, D.", "Goswami, U.", "Kodamana, H.", "Ramteke, M.", "Tamboli, P. K."],
          journal: "Process Safety and Environmental Protection",
          year: "2023",
          area: ["Fault Detection & Health"],
          status: "Published",
          type: "Journal Article",
          url: "#"
        },
        {
          id: 5,
          title: "Multi-objective optimization of monoclonal antibody production in bioreactor",
          authors: ["Kumar, D.", "Gangwar, N.", "Rathore, A. S.", "Ramteke, M."],
          journal: "Chemical Engineering and Processing - Process Intensification",
          year: "2022",
          area: ["Bioprocess Optimization"],
          status: "Published",
          type: "Journal Article",
          url: "#"
        },
        {
          id: 6,
          title: "An improved machine learning-based prediction framework for early detection of events in heart failure patients using mHealth",
          authors: ["Kumar, D.", "Balraj, K.", "Seth, S.", "Vashista, S.", "Ramteke, M.", "Rathore, A. S."],
          journal: "Health and Technology",
          year: "2024",
          area: ["Fault Detection & Health"],
          status: "Published",
          type: "Journal Article",
          url: "#"
        },
        {
          id: 7,
          title: "Learning Interpretable Representation of Koopman Operator for Non-linear Dynamics",
          authors: ["Kumar, D.", "Dixit, V.", "Ramteke, M.", "Kodamana, H."],
          journal: "Computer Aided Chemical Engineering",
          year: "2024",
          area: ["Koopman & Dynamics"],
          status: "Published",
          type: "Conference Article",
          url: "#"
        },
        {
          id: 8,
          title: "Adaptive Fault Detection via Machine Unlearning",
          authors: ["Anto, A.", "Kumar, D.", "Kodamana, H.", "Ramteke, M."],
          journal: "Computers and Chemical Engineering",
          year: "Under Review",
          area: ["Fault Detection & Health"],
          status: "Under Review",
          type: "Journal Article",
          url: "#"
        },
        {
          id: 9,
          title: "Multi-objective Optimization of Hydrocracking Processes Using Graph Neural Differential Equations",
          authors: ["Goswami, U.", "Kumar, D.", "Kodamana, H.", "Ramteke, M."],
          journal: "Chemical Engineering Research and Design",
          year: "2025",
          area: ["Process Modeling"],
          status: "Published",
          type: "Journal Article",
          url: "#"
        },
        {
          id: 10,
          title: "Change Point Detection of Processes using Graph Neural Differential Convolutional Network with Contrastive Loss",
          authors: ["Goswami, U.", "Kumar, D.", "Kodamana, H.", "Ramteke, M."],
          journal: "Process Safety and Environmental Protection",
          year: "2025",
          area: ["Fault Detection & Health"],
          status: "Published",
          type: "Journal Article",
          url: "#"
        },
        {
          id: 11,
          title: "Dynamic optimization for monoclonal antibody production",
          authors: ["Kaysfeld, M. W.", "Kumar, D.", "Nielsen, M. K.", "Jørgensen, J. B."],
          journal: "IFAC-PapersOnLine",
          year: "2023",
          area: ["Bioprocess Optimization"],
          status: "Published",
          type: "Conference Article",
          url: "#"
        },
        {
          id: 12,
          title: "A Twin Agent Reinforcement Learning Framework by Integrating Deterministic and Stochastic Policies",
          authors: ["Gupta, N.", "Anand, S.", "Kumar, D.", "Ramteke, M.", "Kandath, H.", "Kodamana, H."],
          journal: "Industrial & Engineering Chemistry Research",
          year: "2024",
          area: ["Bioprocess Optimization"],
          status: "Published",
          type: "Journal Article",
          url: "#"
        },
        {
          id: 13,
          title: "Proximal policy optimization for the control of mAB production",
          authors: ["Gupta, N.", "Anand, S.", "Kumar, D.", "Ramteke, M.", "Kodamana, H."],
          journal: "Computer Aided Chemical Engineering",
          year: "2023",
          area: ["Bioprocess Optimization"],
          status: "Published",
          type: "Conference Article",
          url: "#"
        },
        {
          id: 14,
          title: "Energy out-of-distribution based fault detection of multivariate time-series data",
          authors: ["Goswami, U.", "Rani, J.", "Kumar, D.", "Kodamana, H.", "Ramteke, M."],
          journal: "Computer Aided Chemical Engineering",
          year: "2023",
          area: ["Fault Detection & Health"],
          status: "Published",
          type: "Conference Article",
          url: "#"
        },
        {
          id: 15,
          title: "Process control of mAb production using multi-actor proximal policy optimization",
          authors: ["Gupta, N.", "Anand, S.", "Joshi, T.", "Kumar, D.", "Ramteke, M.", "Kodamana, H."],
          journal: "Digital Chemical Engineering",
          year: "2023",
          area: ["Bioprocess Optimization"],
          status: "Published",
          type: "Journal Article",
          url: "#"
        }
      ];

      // State Management
      const state = {
        sortBy: 'year-desc',
        filters: {
          areas: new Set(),
          journals: new Set(),
          authors: new Set(),
          types: new Set(),
          yearStart: null,
          yearEnd: null
        }
      };

      // DOM Elements
      const container = document.getElementById('publications-container');
      const activeFiltersContainer = document.getElementById('active-filters');
      
      // Controls
      const sortBtn = document.getElementById('sort-btn');
      const sortMenu = document.getElementById('sort-menu');
      const filterToggleBtn = document.getElementById('filter-toggle-btn');
      const filterPanel = document.getElementById('filter-panel');

      // Filter Inputs & Lists
      const selectArea = document.getElementById('select-area');
      const selectJournal = document.getElementById('select-journal');
      const selectType = document.getElementById('select-type');
      
      const inputAuthor = document.getElementById('input-author');
      const listAuthor = document.getElementById('list-author');

      // Year Inputs
      const yearStartInput = document.getElementById('year-start');
      const yearEndInput = document.getElementById('year-end');

      // Initialize
      function init() {
        setupEventListeners();
        
        // Check URL params for initial filter
        const urlParams = new URLSearchParams(window.location.search);
        const areaParam = urlParams.get('area');
        if (areaParam) {
          const decodedArea = decodeURIComponent(areaParam);
          // Verify it exists
          const areas = [...new Set(publications.flatMap(p => p.area))];
          if (areas.includes(decodedArea)) {
            toggleFilter('areas', decodedArea);
          }
        }

        renderPublications();
        renderActiveFilters();
      }

      function setupEventListeners() {
        // Sort Dropdown
        sortBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          sortMenu.classList.toggle('show');
        });

        // Filter Panel Toggle
        filterToggleBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          filterPanel.classList.toggle('show');
        });

        // Close dropdowns when clicking outside
        document.addEventListener('click', (e) => {
          if (!sortBtn.contains(e.target) && !sortMenu.contains(e.target)) {
            sortMenu.classList.remove('show');
          }
          
          if (!filterToggleBtn.contains(e.target) && !filterPanel.contains(e.target)) {
            filterPanel.classList.remove('show');
          }
          
          // Close autocomplete lists if clicking outside specific input/list pairs
          if (e.target !== inputAuthor && !listAuthor.contains(e.target)) {
            listAuthor.classList.remove('show');
          }
        });

        // Sort Options
        document.querySelectorAll('.sort-option').forEach(btn => {
          btn.addEventListener('click', () => {
            document.querySelectorAll('.sort-option').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            state.sortBy = btn.dataset.value;
            renderPublications();
            sortMenu.classList.remove('show');
          });
        });

        // Setup Select Inputs
        setupSelect(selectArea, 'areas', () => [...new Set(publications.flatMap(p => p.area))].sort());
        setupSelect(selectJournal, 'journals', () => [...new Set(publications.map(p => p.journal))].sort());
        setupSelect(selectType, 'types', () => [...new Set(publications.map(p => p.type))].sort());

        // Setup Autocomplete Inputs (Only for Author)
        const getAuthors = () => {
          const all = publications.flatMap(p => p.authors);
          return [...new Set(all)].filter(a => !a.includes('Kumar, D.')).sort();
        };
        setupAutocomplete(inputAuthor, listAuthor, 'authors', getAuthors);

        // Year Inputs
        const handleYearChange = () => {
          const start = parseInt(yearStartInput.value);
          const end = parseInt(yearEndInput.value);
          
          state.filters.yearStart = !isNaN(start) ? start : null;
          state.filters.yearEnd = !isNaN(end) ? end : null;

          renderPublications();
          renderActiveFilters();
        };

        yearStartInput.addEventListener('input', handleYearChange);
        yearEndInput.addEventListener('input', handleYearChange);
      }

      function setupSelect(selectElement, category, dataProvider) {
        const allItems = dataProvider();
        
        // Populate options
        allItems.forEach(item => {
          const option = document.createElement('option');
          option.value = item;
          option.textContent = item;
          selectElement.appendChild(option);
        });

        // Handle change
        selectElement.addEventListener('change', () => {
          const value = selectElement.value;
          if (value) {
            toggleFilter(category, value);
            selectElement.value = ""; // Reset to default
          }
        });
      }

      function setupAutocomplete(input, listContainer, category, dataProvider) {
        const allItems = dataProvider();

        // Show list on focus
        input.addEventListener('focus', () => {
          renderList(allItems, input.value);
          listContainer.classList.add('show');
        });

        // Show list on click (in case it was closed but still focused)
        input.addEventListener('click', (e) => {
          e.stopPropagation(); // Prevent document click from closing it immediately
          renderList(allItems, input.value);
          listContainer.classList.add('show');
        });

        // Filter list on type
        input.addEventListener('input', () => {
          renderList(allItems, input.value);
          listContainer.classList.add('show');
        });

        // Render list helper
        function renderList(items, query) {
          listContainer.innerHTML = '';
          const lowerQuery = query.toLowerCase();
          
          const filtered = items.filter(item => 
            item.toLowerCase().includes(lowerQuery) && !state.filters[category].has(item)
          );

          if (filtered.length === 0) {
            const div = document.createElement('div');
            div.className = 'option-item';
            div.style.color = '#999';
            div.style.cursor = 'default';
            div.textContent = 'No matches found';
            listContainer.appendChild(div);
            return;
          }

          filtered.forEach(item => {
            const div = document.createElement('div');
            div.className = 'option-item';
            div.textContent = item;
            div.addEventListener('click', (e) => {
              e.stopPropagation(); // Prevent panel close
              toggleFilter(category, item);
              input.value = ''; // Clear input
              renderList(allItems, ''); // Reset list
              input.focus();
            });
            listContainer.appendChild(div);
          });
        }
      }



      function toggleFilter(category, value) {
        if (state.filters[category].has(value)) {
          state.filters[category].delete(value);
        } else {
          state.filters[category].add(value);
        }
        renderPublications();
        renderActiveFilters();
      }

      function renderActiveFilters() {
        activeFiltersContainer.innerHTML = '';
        
        const createChip = (text, removeCallback) => {
          const chip = document.createElement('div');
          chip.className = 'filter-chip';
          chip.innerHTML = `
            ${text}
            <button class="close-btn">×</button>
          `;
          chip.querySelector('.close-btn').addEventListener('click', removeCallback);
          activeFiltersContainer.appendChild(chip);
        };

        // Areas
        state.filters.areas.forEach(area => {
          createChip(area, () => toggleFilter('areas', area));
        });

        // Journals
        state.filters.journals.forEach(journal => {
          createChip(journal, () => toggleFilter('journals', journal));
        });

        // Authors
        state.filters.authors.forEach(author => {
          createChip(author, () => toggleFilter('authors', author));
        });

        // Types
        state.filters.types.forEach(type => {
          createChip(type, () => toggleFilter('types', type));
        });

        // Year
        if (state.filters.yearStart || state.filters.yearEnd) {
          const text = `Year: ${state.filters.yearStart || '...'} - ${state.filters.yearEnd || '...'}`;
          createChip(text, () => {
            state.filters.yearStart = null;
            state.filters.yearEnd = null;
            yearStartInput.value = '';
            yearEndInput.value = '';
            renderPublications();
            renderActiveFilters();
          });
        }
      }

      function renderPublications() {
        // 1. Filter
        let filtered = publications.filter(p => {
          // Area (OR logic within category)
          // p.area is now an array. Check if ANY of the paper's areas match ANY of the selected filters.
          // If no filters selected, match all.
          const matchArea = state.filters.areas.size === 0 || 
            p.area.some(a => state.filters.areas.has(a));
          
          // Journal (OR logic)
          const matchJournal = state.filters.journals.size === 0 || state.filters.journals.has(p.journal);

          // Author (OR logic)
          const matchAuthor = state.filters.authors.size === 0 || 
            p.authors.some(a => state.filters.authors.has(a));

          // Type (OR logic)
          const matchType = state.filters.types.size === 0 || state.filters.types.has(p.type);

          // Year
          let pYear = parseInt(p.year);
          if (p.year === 'Under Review') pYear = new Date().getFullYear() + 1;
          
          const start = state.filters.yearStart || 0;
          const end = state.filters.yearEnd || 9999;
          const matchYear = pYear >= start && pYear <= end;

          return matchArea && matchJournal && matchAuthor && matchType && matchYear;
        });

        // 2. Sort
        filtered.sort((a, b) => {
          const sortVal = state.sortBy;
          if (sortVal === 'year-desc') {
            if (a.year === 'Under Review') return -1;
            if (b.year === 'Under Review') return 1;
            return parseInt(b.year) - parseInt(a.year);
          } else if (sortVal === 'year-asc') {
            if (a.year === 'Under Review') return 1;
            if (b.year === 'Under Review') return -1;
            return parseInt(a.year) - parseInt(b.year);
          } else if (sortVal === 'title-asc') {
            return a.title.localeCompare(b.title);
          } else if (sortVal === 'journal-asc') {
            return a.journal.localeCompare(b.journal);
          }
          return 0;
        });

        // 3. Render
        container.innerHTML = '';
        
        if (filtered.length === 0) {
          container.innerHTML = '<p>No publications found matching your criteria.</p>';
          return;
        }

        const ol = document.createElement('ol');
        ol.className = 'pub-list';

        filtered.forEach(p => {
          const li = document.createElement('li');
          li.classList.add('scroll-hidden'); // Add animation class
          
          // Highlight current author
          const formattedAuthors = p.authors.map(a => {
            return a.includes('Kumar, D.') ? `<strong>${a}</strong>` : a;
          }).join(', ');

          li.innerHTML = `
            ${formattedAuthors} (${p.year === 'Under Review' ? 'Under Review' : p.year}).
            ${p.title}.
            <em>${p.journal}</em>.
            <a href="${p.url}" class="pub-link" target="_blank" rel="noopener">[View Article]</a>
          `;
          ol.appendChild(li);
        });

        container.appendChild(ol);
        
        // Observe new elements for animation
        if (window.observeElements) {
            window.observeElements(ol.querySelectorAll('li'));
        }
      }

      // Run init
      init();
    </script>
  </body>
</html>
